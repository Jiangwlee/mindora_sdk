# Docker Compose åŸºç¡€è®¾æ–½é…ç½® - å¼€å‘è®¡åˆ’

## æ€»è§ˆ
å®ç°å®Œæ•´çš„Docker ComposeåŸºç¡€è®¾æ–½é…ç½®ç³»ç»Ÿï¼Œæ”¯æŒå¤šç¯å¢ƒéƒ¨ç½²ï¼ŒåŒ…å«å®Œæ•´çš„ç›‘æ§ã€é…ç½®ç®¡ç†ã€å¤‡ä»½è„šæœ¬ç­‰åŠŸèƒ½ã€‚

## ä»»åŠ¡æ¸…å•

### ğŸ—ï¸ é˜¶æ®µä¸€ï¼šç¯å¢ƒé…ç½®æ–‡ä»¶

- [x] **ä»»åŠ¡1.1**: åˆ›å»ºç¯å¢ƒå˜é‡æ¨¡æ¿æ–‡ä»¶ `infrastructure/docker/.env.example`
- [x] **ä»»åŠ¡1.2**: æ›´æ–°å¼€å‘ç¯å¢ƒé…ç½® `infrastructure/docker/docker-compose.dev.yml` (ç‰ˆæœ¬å‡çº§å’Œä¼˜åŒ–)
- [x] **ä»»åŠ¡1.3**: åˆ›å»ºæµ‹è¯•ç¯å¢ƒé…ç½® `infrastructure/docker/docker-compose.test.yml`
- [x] **ä»»åŠ¡1.4**: åˆ›å»ºç”Ÿäº§ç¯å¢ƒé…ç½® `infrastructure/docker/docker-compose.prod.yml`

### ğŸ”§ é˜¶æ®µäºŒï¼šæœåŠ¡é…ç½®æ–‡ä»¶

- [x] **ä»»åŠ¡2.1**: åˆ›å»ºNginxé…ç½® `infrastructure/configs/nginx/nginx.conf`
- [x] **ä»»åŠ¡2.2**: åˆ›å»ºPrometheusé…ç½® `infrastructure/configs/prometheus/prometheus.yml`
- [x] **ä»»åŠ¡2.3**: åˆ›å»ºGrafanaæ•°æ®æºé…ç½® `infrastructure/configs/grafana/datasources/prometheus.yml`
- [x] **ä»»åŠ¡2.4**: åˆ›å»ºGrafanaç›‘æ§ä»ªè¡¨æ¿ `infrastructure/configs/grafana/dashboards/mindora-overview.json`
- [x] **ä»»åŠ¡2.5**: åˆ›å»ºConsulæœåŠ¡å™¨é…ç½® `infrastructure/configs/consul/server.json`

### ğŸ—„ï¸ é˜¶æ®µä¸‰ï¼šæ•°æ®åº“åˆå§‹åŒ–

- [x] **ä»»åŠ¡3.1**: åˆ›å»ºPostgreSQL Schemaåˆå§‹åŒ–è„šæœ¬ `infrastructure/init/postgres/01-create-schemas.sql`
- [x] **ä»»åŠ¡3.2**: åˆ›å»ºPostgreSQLåˆå§‹æ•°æ®è„šæœ¬ `infrastructure/init/postgres/02-init-data.sql`
- [x] **ä»»åŠ¡3.3**: åˆ›å»ºConsul KVåˆå§‹åŒ–é…ç½® `infrastructure/init/consul/kv-init.json`

### ğŸ› ï¸ é˜¶æ®µå››ï¼šè¿ç»´è„šæœ¬

- [x] **ä»»åŠ¡4.1**: åˆ›å»ºç¯å¢ƒåˆå§‹åŒ–è„šæœ¬ `infrastructure/scripts/setup.sh`
- [ ] **ä»»åŠ¡4.2**: åˆ›å»ºæ•°æ®å¤‡ä»½è„šæœ¬ `infrastructure/scripts/backup.sh`
- [ ] **ä»»åŠ¡4.3**: åˆ›å»ºæ•°æ®æ¢å¤è„šæœ¬ `infrastructure/scripts/restore.sh`
- [ ] **ä»»åŠ¡4.4**: åˆ›å»ºå¥åº·æ£€æŸ¥è„šæœ¬ `infrastructure/scripts/health-check.sh`
- [ ] **ä»»åŠ¡4.5**: åˆ›å»ºéƒ¨ç½²è„šæœ¬ `infrastructure/scripts/deploy.sh`

### âš™ï¸ é˜¶æ®µäº”ï¼šé¡¹ç›®é…ç½®æ›´æ–°

- [x] **ä»»åŠ¡5.1**: æ›´æ–° `justfile` æ·»åŠ åŸºç¡€è®¾æ–½ç®¡ç†å‘½ä»¤
- [ ] **ä»»åŠ¡5.2**: æ›´æ–° `.gitignore` æ·»åŠ åŸºç¡€è®¾æ–½æ•°æ®å¿½ç•¥è§„åˆ™

### ğŸ§ª é˜¶æ®µå…­ï¼šæµ‹è¯•å®ç°

- [ ] **ä»»åŠ¡6.1**: åˆ›å»ºé…ç½®éªŒè¯æµ‹è¯• `tests/integration/test_docker_compose_config.py`
- [ ] **ä»»åŠ¡6.2**: åˆ›å»ºæœåŠ¡å¯åŠ¨æµ‹è¯• `tests/integration/test_service_startup.py`
- [ ] **ä»»åŠ¡6.3**: åˆ›å»ºæœåŠ¡è¿é€šæ€§æµ‹è¯• `tests/integration/test_service_connectivity.py`
- [ ] **ä»»åŠ¡6.4**: åˆ›å»ºç«¯åˆ°ç«¯å·¥ä½œæµæµ‹è¯• `tests/e2e/test_infrastructure_workflow.py`

### ğŸ“š é˜¶æ®µä¸ƒï¼šæ–‡æ¡£å®Œå–„

- [ ] **ä»»åŠ¡7.1**: æ›´æ–°é¡¹ç›®README.mdæ·»åŠ åŸºç¡€è®¾æ–½ä½¿ç”¨è¯´æ˜
- [ ] **ä»»åŠ¡7.2**: åˆ›å»ºåŸºç¡€è®¾æ–½éƒ¨ç½²æŒ‡å— `docs/infrastructure-deployment.md`
- [ ] **ä»»åŠ¡7.3**: åˆ›å»ºæ•…éšœæ’æŸ¥æŒ‡å— `docs/troubleshooting.md`

## å®æ–½é¡ºåº
1. ä¼˜å…ˆå®Œæˆé˜¶æ®µä¸€å’Œé˜¶æ®µäºŒï¼ˆæ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼‰
2. ç„¶åå®æ–½é˜¶æ®µä¸‰å’Œé˜¶æ®µå››ï¼ˆåˆå§‹åŒ–å’Œè¿ç»´è„šæœ¬ï¼‰
3. æ¥ç€å®Œæˆé˜¶æ®µäº”ï¼ˆé¡¹ç›®é…ç½®æ›´æ–°ï¼‰
4. æœ€åå®æ–½é˜¶æ®µå…­å’Œé˜¶æ®µä¸ƒï¼ˆæµ‹è¯•å’Œæ–‡æ¡£ï¼‰

## éªŒæ”¶æ ‡å‡†
- [ ] æ‰€æœ‰ç¯å¢ƒçš„Docker Composeé…ç½®æ–‡ä»¶è¯­æ³•éªŒè¯é€šè¿‡
- [ ] å¼€å‘ç¯å¢ƒèƒ½å¤ŸæˆåŠŸå¯åŠ¨æ‰€æœ‰æœåŠ¡å¹¶é€šè¿‡å¥åº·æ£€æŸ¥
- [ ] æµ‹è¯•ç¯å¢ƒèƒ½å¤Ÿå¿«é€Ÿå¯åŠ¨å’Œæ¸…ç†
- [ ] ç”Ÿäº§ç¯å¢ƒé…ç½®ç¬¦åˆå®‰å…¨å’Œæ€§èƒ½è¦æ±‚
- [ ] è¿ç»´è„šæœ¬èƒ½å¤Ÿæ­£å¸¸æ‰§è¡Œå¤‡ä»½å’Œæ¢å¤æ“ä½œ
- [ ] æ‰€æœ‰é›†æˆæµ‹è¯•é€šè¿‡
- [ ] æ–‡æ¡£å®Œæ•´ä¸”æ˜“äºç†è§£

## é£é™©ç¼“è§£
- åœ¨æ¯ä¸ªé˜¶æ®µå®Œæˆåè¿›è¡ŒéªŒè¯æµ‹è¯•
- ä¿æŒç°æœ‰å¼€å‘ç¯å¢ƒé…ç½®çš„å…¼å®¹æ€§
- æä¾›å›æ»šæœºåˆ¶ä»¥é˜²é…ç½®é”™è¯¯
- åˆ†æ­¥éª¤å®æ–½ï¼Œé¿å…ä¸€æ¬¡æ€§å¤§æ”¹åŠ¨